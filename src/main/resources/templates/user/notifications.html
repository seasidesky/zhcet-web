<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4"
      lang="en"
      data-textdirection="ltr"
      class="loading">
<head th:replace="fragments/layout :: head"></head>
<style>
    .title, .title > p {
        padding: 0;
        margin: 0;
    }

    .new {
        background-color: #DCEDC8;
    }

    .card-header {
        min-height: 55px;
    }

    .fav {
        padding: 0 0 5px 0;
    }
</style>
<body data-open="click" data-menu="vertical-menu" data-col="2-columns" class="vertical-layout vertical-menu 2-columns fixed-navbar">

<div th:fragment="content" th:replace="fragments/layout :: wrapper(pageId = 'profile')" sec:authorize="isAuthenticated()">
    <!--/*@thymesVar id="currentPage" type="java.lang.Integer"*/-->
    <!--/*@thymesVar id="minPage" type="java.lang.Integer"*/-->
    <!--/*@thymesVar id="maxPage" type="java.lang.Integer"*/-->
    <!--/*@thymesVar id="notifications" type="java.util.List"*/-->

    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-lg-10 offset-lg-1 col-xl-8 offset-xl-2">
                <div th:replace="fragments/layout :: toolbar"></div>

                <div th:replace="fragments/layout :: success(condition = ${notification_success}, message = ${notification_success})"></div>

                <div class="col-xs-12" th:unless="${notifications.isEmpty()}">
                    <div class="float-xs-right">
                        <a th:href="@{/notifications}" th:if="${favorite_page}">
                            <button class="btn btn-round text-white bg-primary">All Notifications</button>
                        </a>
                        <a th:href="@{/notifications/favorite}" th:unless="${favorite_page}">
                            <button class="btn btn-round text-white" style="background-color: #E91E63">Favorites</button>
                        </a>
                        <form th:action="@{/notifications/mark/read}" method="post" style="display: inline-block">
                            <input type="text" name="page" th:value="${currentPage}" hidden>
                            <button type="submit" class="btn btn-round text-white bg-success">Mark all as read</button>
                        </form>
                    </div>
                </div>

                <div th:fragment="pagination" class="text-xs-center pages my-1">
                    <nav aria-label="Page navigation">
                        <ul class="pagination pagination-round">
                            <li th:class="|page-item ${currentPage <= minPage ? 'disabled' : ''}|">
                                <a class="page-link" th:href="@{/notifications(page=${currentPage - 1})}" aria-label="Previous">
                                    <span aria-hidden="true">&laquo;</span>
                                    <span class="sr-only">Previous</span>
                                </a>
                            </li>
                            <li th:each="num : ${#numbers.sequence(minPage, maxPage)}" th:class="|page-item ${currentPage == num ? 'active' : ''}|">
                                <a class="page-link" th:href="@{/notifications(page=${num})}" th:text="${num}">1</a>
                            </li>
                            <li th:class="|page-item ${currentPage >= maxPage ? 'disabled' : ''}|">
                                <a class="page-link" th:href="@{/notifications(page=${currentPage + 1})}" aria-label="Next">
                                    <span aria-hidden="true">&raquo;</span>
                                    <span class="sr-only">Next</span>
                                </a>
                            </li>
                        </ul>
                    </nav>
                </div>

                <!--/*@thymesVar id="notificationRecipient" type="in.ac.amu.zhcet.data.model.notification.NotificationRecipient"*/-->

                <div th:if="${notifications.isEmpty()}" class="text-xs-center text-muted">
                    <h3>No notifications</h3>
                </div>

                <div th:each="notificationRecipient : ${notifications}" class="row">
                    <div class="col-xs-12">
                        <div class="card">
                            <div th:class="|card-header ${notificationRecipient.seen ? '' : 'new'}|">
                                <h4 class="title" th:utext="${@markDownService.render(notificationRecipient.notification.title)}"></h4>
                                <a class="heading-elements-toggle"><i class="icon-ellipsis font-medium-3"></i></a>
                                <div class="heading-elements">
                                    <ul class="list-inline mb-0">
                                        <li>
                                            <form method="post" th:action="@{|/notifications/mark/favorite/${notificationRecipient.id}|}">
                                                <input type="text" name="page" th:value="${currentPage}" hidden>
                                                <button type="submit" class="fav btn btn-icon btn-pure">
                                                    <i th:class="${notificationRecipient.favorite ? 'icon-star-full' : 'icon-star-empty'}"></i>
                                                </button>
                                            </form>
                                        </li>
                                        <li><a data-action="collapse"><i class="icon-minus4"></i></a></li>
                                        <li><a data-action="reload"><i class="icon-reload"></i></a></li>
                                        <li><a data-action="expand"><i class="icon-expand2"></i></a></li>
                                    </ul>
                                </div>
                            </div>
                            <div class="card-body collapse in">
                                <div class="card-block" th:utext="${@markDownService.render(notificationRecipient.notification.message)}"></div>
                            </div>
                            <blockquote class="p-1">
                                <span>From : <code th:text="${notificationRecipient.notification.sender.name}"></code>
                                    <span th:if="${notificationRecipient.notification.automated}">
                                        <i data-toggle="tooltip" data-original-title="Automated" class="icon-asterisk"></i>
                                    </span>
                                </span>
                                <span class="float-xs-right"><em th:text="${#temporals.format(notificationRecipient.notification.sentTime)}"></em></span>
                            </blockquote>
                        </div>
                    </div>
                </div>
                <div th:replace="this :: pagination"></div>
            </div>
        </div>
    </div>
</div>
</body>
</html>
